"use strict";(self.webpackChunkdora_rs_github_io=self.webpackChunkdora_rs_github_io||[]).push([[4815],{23142:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var i=t(74848),r=t(28453);const s={sidebar_position:1},a="Python Conversation",o={id:"guides/getting-started/conversation_py",title:"Python Conversation",description:"1. Install Dora CLI and Dependencies",source:"@site/docs/guides/getting-started/conversation_py.md",sourceDirName:"guides/getting-started",slug:"/guides/getting-started/conversation_py",permalink:"/docs/guides/getting-started/conversation_py",draft:!1,unlisted:!1,editUrl:"https://github.com/dora-rs/dora-rs.github.io/edit/main/docs/guides/getting-started/conversation_py.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"guides",previous:{title:"Uninstalling",permalink:"/docs/guides/Installation/uninstalling"},next:{title:"Webcam Plot",permalink:"/docs/guides/getting-started/webcam_plot"}},l={},d=[];function c(e){const n={code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"python-conversation",children:"Python Conversation"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Install Dora CLI and Dependencies\nFirst, ensure you have Python 3.11 installed."}),"\n",(0,i.jsx)(n.p,{children:"Create and Activate Virtual Environment\nCreate a clean virtual environment using uv:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"uv venv --seed -p 3.11\nsource .venv/bin/activate  # Linux/macOS\n.venv\\Scripts\\activate     # Windows\n"})}),"\n",(0,i.jsx)(n.p,{children:"Install Dora CLI"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"pip install dora-rs-cli\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a new dataflow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Create a new Python-based dataflow and navigate into the project directory\ndora new conversation_py --lang python\ncd conversation_py\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This creates the following ",(0,i.jsx)(n.code,{children:"conversation_py"})," directory"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\u251c\u2500\u2500 dataflow.yml\n\u251c\u2500\u2500 listener-1\n\u2502   \u251c\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 listener_1\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 __main__.py\n\u2502   \u2502   \u2514\u2500\u2500 main.py\n\u2502   \u251c\u2500\u2500 pyproject.toml\n\u2502   \u2514\u2500\u2500 tests\n\u2502       \u2514\u2500\u2500 test_listener_1.py\n\u251c\u2500\u2500 talker-1\n\u2502   \u251c\u2500\u2500 README.md\n\u2502   \u251c\u2500\u2500 pyproject.toml\n\u2502   \u251c\u2500\u2500 talker_1\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 __main__.py\n\u2502   \u2502   \u2514\u2500\u2500 main.py\n\u2502   \u2514\u2500\u2500 tests\n\u2502       \u2514\u2500\u2500 test_talker_1.py\n\u2514\u2500\u2500 talker-2\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 pyproject.toml\n    \u251c\u2500\u2500 talker_2\n    \u2502   \u251c\u2500\u2500 __init__.py\n    \u2502   \u251c\u2500\u2500 __main__.py\n    \u2502   \u2514\u2500\u2500 main.py\n    \u2514\u2500\u2500 tests\n       \u2514\u2500\u2500 test_talker_2.py\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"For example you can add another node to the workspace with"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:" dora new --kind node talker --lang python\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now open up the ",(0,i.jsx)(n.code,{children:"talker-1/talker_1/main.py"})," file in your text editor."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"How the default node works"}),"\n",(0,i.jsx)(n.p,{children:"Your node is very bare bones right now but here is an explanation of what is going on in it by default."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This section imports and initializes the node."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from dora import Node\nimport pyarrow as pa\n\ndef main():\n   node = Node()\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This part of the code checks to see if the node has received any input, and if it has, it will print out some data relating to the input."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'for event in node:\n   if event["type"] == "INPUT":\n      print(\n         f"""Node received:\n      id: {event["id"]},\n      value: {event["value"]},\n      metadata: {event["metadata"]}"""\n      )\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This line send an output to other nodes."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'      node.send_output("speech", pa.array(["Hello World"])) # add this line\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["We are using the ",(0,i.jsx)(n.code,{children:"send_output"})," method to send a string as an arrow array to the listener node."]}),"\n",(0,i.jsx)(n.li,{children:"The first argument is the id of the output we want to send to be referenced later in the dataflow."}),"\n",(0,i.jsxs)(n.li,{children:["The second argument, ",(0,i.jsx)(n.code,{children:'pa.array(["Hello World"])'}),", uses Apache Arrow to handle the data. Here, ",(0,i.jsx)(n.code,{children:"pa.array"})," creates an Arrow array from the list ",(0,i.jsx)(n.code,{children:'["Hello World"]'}),"."]}),"\n",(0,i.jsx)(n.li,{children:"The third argument for metadata is omitted here, indicating that no additional data about the transmission is necessary for this tutorial."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Let's breakdown the listener node"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'  from dora import Node\n\n\n   def main():\n      node = Node()\n      for event in node:\n         if event["type"] == "INPUT":\n               message = event["value"][0].as_py()\n               print(f"""I heard {message} from {event["id"]}""")\n\n\n   if __name__ == "__main__":\n      main()\n'})}),"\n",(0,i.jsx)(n.p,{children:"Let's break down the key line in this script."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:'event["value"]'})," contains an Apache Arrow array, which is a structured way to handle complex data efficiently. By accessing ",(0,i.jsx)(n.code,{children:"[0]"}),", we retrieve the first element of this array."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:".as_py()"})," method converts the Arrow element directly into a native Python data type."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Running the dataflow"}),"\n",(0,i.jsx)(n.p,{children:"Before we can run the dataflow we have to change it first:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"nodes:\n  - id: talker\n    path: talker-1/talker_1/main.py\n    inputs:\n      tick: dora/timer/secs/1\n    outputs:\n      - speech\n\n  - id: listener\n    path: listener-1/listener_1/main.py\n    inputs:\n      speech: talker/speech\n"})}),"\n",(0,i.jsx)(n.p,{children:"Before we run the dataflow, let's go over it really quick."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The talker node will be sent an input every second, which will then make it send an output."}),"\n",(0,i.jsx)(n.li,{children:"The listener node will be sent an input from the talker node and will then print out what it heard."}),"\n",(0,i.jsx)(n.li,{children:"The name of the output of the talker corresponds to the id set in the talker node."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Now lets run the dataflow."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\n# Build dataflow (install dependencies):\ndora build dataflow.yml --uv\n\n# Run the dataflow\ndora run dataflow.yml --uv\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You should see the listener node print out the message ",(0,i.jsx)(n.code,{children:'"I heard Hello World from speech"'}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"Well done reaching the end of this tutorial! You've learned to create and run a custom Dora dataflow, integrating a talker and listener node. This setup forms the foundation for more complex dataflows. For further exploration, consider experimenting with different data types or exploring Dora's advanced features. More tutorials coming soon!"}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);