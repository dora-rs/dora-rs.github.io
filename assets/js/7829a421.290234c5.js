"use strict";(self.webpackChunkdora_rs_github_io=self.webpackChunkdora_rs_github_io||[]).push([[8149],{16430:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var t=o(74848),s=o(28453);const a={sidebar_position:4},i="Planning",r={id:"guides/dora-drives/planning",title:"Planning",description:"To make the car drive itself we first need to plan the way we want to go.",source:"@site/docs/guides/dora-drives/planning.mdx",sourceDirName:"guides/dora-drives",slug:"/guides/dora-drives/planning",permalink:"/docs/guides/dora-drives/planning",draft:!1,unlisted:!1,editUrl:"https://github.com/dora-rs/dora-rs.github.io/edit/main/docs/guides/dora-drives/planning.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"guides",previous:{title:"Obstacle location",permalink:"/docs/guides/dora-drives/obstacle_location"},next:{title:"Control",permalink:"/docs/guides/dora-drives/control"}},l={},c=[{value:"GPS",id:"gps",level:2},{value:"Planner",id:"planner",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"planning",children:"Planning"}),"\n",(0,t.jsx)(n.p,{children:"To make the car drive itself we first need to plan the way we want to go."}),"\n",(0,t.jsx)(n.h2,{id:"gps",children:"GPS"}),"\n",(0,t.jsx)(n.p,{children:"To do this, we're going to use gps to trace the route from our current location to our target location."}),"\n",(0,t.jsxs)(n.p,{children:["Carla ",(0,t.jsx)(n.code,{children:"GlobalRoutePlanner"})," enables us to get the route from two points given a map. We have encapsulated this function within ",(0,t.jsx)(n.code,{children:"operators/carla_gps_op.py"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The following operator will compute the route from the current ",(0,t.jsx)(n.code,{children:"position"})," to the ",(0,t.jsx)(n.code,{children:"objective_waypoints"})," given an ",(0,t.jsx)(n.code,{children:"opendrive"})," map."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"  - id: carla_gps_op\n    operator:\n      python: ../../carla/carla_gps_op.py\n      outputs:\n        - gps_waypoints\n      inputs:\n        opendrive: oasis_agent/opendrive\n        objective_waypoints: oasis_agent/objective_waypoints\n        position: oasis_agent/position\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["The waypoints are defined as a an array of ",(0,t.jsx)(n.code,{children:"x, y, speed"})," as ",(0,t.jsx)(n.code,{children:"float32"})," waypoints, with global coordinates."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"planner",children:"Planner"}),"\n",(0,t.jsx)(n.p,{children:"The GPS waypoints does not take into account obstacles. To avoid collision, we can implement a motion planner that can avoid obstacles."}),"\n",(0,t.jsxs)(n.p,{children:["We're going to reuse a model called ",(0,t.jsx)(n.code,{children:"fot"})," (Frenet Optimal Trajectory) as a black box, that take as input a starting location and a goal waypoints, as well as a list of obstacles and outputs the best waypoints to follow."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"  - id: fot_op\n    operator:\n      python: operators/fot_op.py\n      outputs:\n        - waypoints\n      inputs:\n        position: oasis_agent/position\n        obstacles: obstacle_location_op/obstacles\n        gps_waypoints: carla_gps_op/gps_waypoints\n"})}),"\n",(0,t.jsx)(n.p,{children:"To test both functionallities:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dora up\ndora start graphs/oasis/oasis_agent_planning.yaml --attach\n"})}),"\n",(0,t.jsx)("p",{align:"center",children:(0,t.jsx)("img",{src:"/img/planning.png",width:"800"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["For more information on ",(0,t.jsx)(n.code,{children:"fot"}),", go on ",(0,t.jsxs)(n.a,{href:"/docs/nodes_operators/fot_op",children:["our ",(0,t.jsx)(n.code,{children:"fot"})," detail page"]})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>r});var t=o(96540);const s={},a=t.createContext(s);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);